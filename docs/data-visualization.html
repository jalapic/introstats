<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Visualization | PSY317L &amp; PSY120R Textbook</title>
  <meta name="description" content="Chapter 4 Data Visualization | PSY317L &amp; PSY120R Textbook" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Visualization | PSY317L &amp; PSY120R Textbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Visualization | PSY317L &amp; PSY120R Textbook" />
  
  
  

<meta name="author" content="James P. Curley &amp; Tyler M. Milewski" />


<meta name="date" content="2021-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-caucus-race-and-a-long-tale.html"/>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to Statistics & R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to PSY317 / PSY120R !</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-this-book-includes-and-what-it-doesnt"><i class="fa fa-check"></i><b>1.1</b> What this book includes and what it doesn’t</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-this-guide"><i class="fa fa-check"></i><b>1.2</b> How to use this guide</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.4</b> References</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#other-places-to-find-help-about-r-and-statistics"><i class="fa fa-check"></i><b>1.5</b> Other places to find help about R and Statistics</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-pool-of-tears.html"><a href="the-pool-of-tears.html"><i class="fa fa-check"></i><b>2</b> The pool of tears</a></li>
<li class="chapter" data-level="3" data-path="a-caucus-race-and-a-long-tale.html"><a href="a-caucus-race-and-a-long-tale.html"><i class="fa fa-check"></i><b>3</b> A caucus-race and a long tale</a></li>
<li class="chapter" data-level="4" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>4</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization.html"><a href="data-visualization.html#introduction-to-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization.html"><a href="data-visualization.html#assigning-plots"><i class="fa fa-check"></i><b>4.1.1</b> Assigning plots</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-visualization.html"><a href="data-visualization.html#titles-and-axes-titles"><i class="fa fa-check"></i><b>4.1.2</b> Titles and Axes Titles</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-visualization.html"><a href="data-visualization.html#colors-shapes-and-sizes"><i class="fa fa-check"></i><b>4.1.3</b> Colors, Shapes and Sizes</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-visualization.html"><a href="data-visualization.html#themes"><i class="fa fa-check"></i><b>4.1.4</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization.html"><a href="data-visualization.html#histograms"><i class="fa fa-check"></i><b>4.2</b> Histograms</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualization.html"><a href="data-visualization.html#histograms-with-ggplot2"><i class="fa fa-check"></i><b>4.2.1</b> Histograms with ggplot2</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualization.html"><a href="data-visualization.html#density-curves"><i class="fa fa-check"></i><b>4.2.2</b> Density Curves</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualization.html"><a href="data-visualization.html#comparing-distributions"><i class="fa fa-check"></i><b>4.2.3</b> Comparing Distributions</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-visualization.html"><a href="data-visualization.html#stem-and-leaf-plots"><i class="fa fa-check"></i><b>4.2.4</b> Stem-and-Leaf Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualization.html"><a href="data-visualization.html#scatterplots"><i class="fa fa-check"></i><b>4.3</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualization.html"><a href="data-visualization.html#bubble-charts"><i class="fa fa-check"></i><b>4.3.1</b> Bubble Charts</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualization.html"><a href="data-visualization.html#line-graphs"><i class="fa fa-check"></i><b>4.4</b> Line Graphs</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization.html"><a href="data-visualization.html#multiple-line-graphs"><i class="fa fa-check"></i><b>4.4.1</b> Multiple Line Graphs</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization.html"><a href="data-visualization.html#comparing-distributions-across-groups"><i class="fa fa-check"></i><b>4.5</b> Comparing Distributions across Groups</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualization.html"><a href="data-visualization.html#strip-plots"><i class="fa fa-check"></i><b>4.5.1</b> Strip Plots</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualization.html"><a href="data-visualization.html#boxplots"><i class="fa fa-check"></i><b>4.5.2</b> Boxplots</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-visualization.html"><a href="data-visualization.html#violin-plots"><i class="fa fa-check"></i><b>4.5.3</b> Violin Plots</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-visualization.html"><a href="data-visualization.html#stacked-boxplots"><i class="fa fa-check"></i><b>4.5.4</b> Stacked Boxplots</a></li>
<li class="chapter" data-level="4.5.5" data-path="data-visualization.html"><a href="data-visualization.html#ridgeline-plots"><i class="fa fa-check"></i><b>4.5.5</b> Ridgeline Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualization.html"><a href="data-visualization.html#bar-graphs"><i class="fa fa-check"></i><b>4.6</b> Bar Graphs</a></li>
<li class="chapter" data-level="4.7" data-path="data-visualization.html"><a href="data-visualization.html#small-multiples"><i class="fa fa-check"></i><b>4.7</b> Small Multiples</a></li>
<li class="chapter" data-level="4.8" data-path="data-visualization.html"><a href="data-visualization.html#saving-and-exporting-ggplot2-graphs"><i class="fa fa-check"></i><b>4.8</b> Saving and Exporting ggplot2 graphs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSY317L &amp; PSY120R Textbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Visualization</h1>
<p>In this chapter we shall discuss how we can make different types of data visualization in R. We will use the package <code>ggplot2</code> to visualize data. This is part of the <code>tidyverse</code> package, meaning you should load <code>tidyverse</code> to ensure you have <code>ggplot2</code> loaded.</p>
<p>We shall also discuss a little bit about when to make different types of graphs, and what each type is best suited for. We will also give a few pieces of advice about how to make your visualizations as readable and interpretable as possible. For much more information on the theory of data visualization with excellent examples, please refer to the <a href="https://serialmentor.com/dataviz/">Fundamentals of Data Visualization</a> book by Claus Wilke. To understand the power behind <code>ggplot2</code> and for more data visualization examples, see the <a href="https://ggplot2-book.org/index.html">ggplot2: Elegant Graphics for Data Analysis</a> by Hadley Wickham.</p>
<div id="introduction-to-ggplot2" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction to ggplot2</h2>
<p>The first thing to do when we want to make a visualization with <code>ggplot2</code> is to load the tidyverse:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-visualization.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Next, let’s load in some data. We’ll pick the <code>BlueJays.csv</code> data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-visualization.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/BlueJays.csv&quot;</span>)</span>
<span id="cb2-2"><a href="data-visualization.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="data-visualization.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   BirdID     KnownSex BillDepth BillWidth BillLength  Head  Mass Skull   Sex
##   &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0000-00000 M             8.26      9.21       25.9  56.6  73.3  30.7     1
## 2 1142-05901 M             8.54      8.76       25.0  56.4  75.1  31.4     1
## 3 1142-05905 M             8.39      8.78       26.1  57.3  70.2  31.2     1
## 4 1142-05907 F             7.78      9.3        23.5  53.8  65.5  30.3     0
## 5 1142-05909 M             8.71      9.84       25.5  57.3  74.9  31.8     1
## 6 1142-05911 F             7.28      9.3        22.2  52.2  63.9  30       0</code></pre>
<p>In the next few steps, we’ll slowly build up a plot using <code>ggplot2</code>. This is <strong>not</strong> how you would typically write the code. However, it is worth going step by step, just to show you the logic behind the code.</p>
<p>If we just run the function <code>ggplot()</code> notice that all we get is a blank gray canvas. R knows that we want to make a plot, but it has no idea what type of plot or with what data - so it just throws up the canvas:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-visualization.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<p>Now, if we add the dataset to <code>ggplot()</code>, it still only gives us the blank canvas. It now knows we want to make a graph from the dataset called <code>df</code> but doesn’t plot anything yet as we didn’t tell it what to plot:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-visualization.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)   </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" width="480" /></p>
<p>For R to ‘know’ what you are trying to plot, you need to use <strong><code>aes()</code></strong>. You put that most of the time inside <code>ggplot()</code> after your dataframe name. (There are exceptions to this, but let’s not worry about that yet). Inside the <code>aes()</code> we’ll put what columns contain our data for the x and y axes. We may also refer to other columns inside <code>aes()</code> if we wish to modify the color or shape or something else about our data based on the values in some column.</p>
<p>For our first example, let’s make a <strong>scatterplot</strong> of body mass against head size of these Blue Jays. If you look at the original dataset, you’ll notice that both the <code>Mass</code> and <code>Head</code> columns contain continuous numeric data (i.e. they are numbers).</p>
<p>In the code below, we are telling <code>aes()</code> to plot the <code>Mass</code> data on the x-axis and to plot the <code>Head</code> data on the y-axis.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-visualization.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) )   </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-5-1.png" width="480" /></p>
<p>Something did change this time. We get a plot with labels on the x- and y-axes. It recognizes that we wish to plot <code>Mass</code> and <code>Head</code> data. It even knows the range of our data on each axis. For instance, it knows that the Mass data lies somewhere between 55 and 85. However, we haven’t yet told it precisely what type of plot we want to make (it doesn’t just assume that we wanted to make a scatterplot - it can’t read our minds).</p>
<p>So our next step is to tell it to make a scatterplot by adding points to the graph. We tell <code>ggplot()</code> what we are adding to the chart by using different <code>geoms</code>. For a scatterplot, the geom we require is <code>geom_point()</code> - that means add datapoints. It is hard to remember all the different geoms, but you can just look them up.</p>
<p>Here is how we add datapoints to our graph with <code>+ geom_point()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-visualization.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="480" /></p>
<p>That is our first ggplot graph! It looks pretty good. The amazing thing about ggplot is almost everything you are looking at on that graph can be customized to your preferred design choice. We’ll discuss several of these customizations throughout this chapter. First, let’s talk about changing the color of the datapoints. Inside of <code>geom_point()</code> we can change the color of all the points like this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-visualization.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-7-1.png" width="480" /></p>
<p>This made the points red. Just make sure you put a recognized color name (<a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">you can look them up here</a>) or a recognized <a href="https://htmlcolorcodes.com/color-picker/">hex code</a>. Notice though that color name must be put inside of quotes.</p>
<p>What if we want to color the points based on another variable? For example, instead of having all of our data points be red, say we want them to be colored based on whether the birds or male or female? The column that has the information about whether the birds are male or female is <code>KnownSex</code>. Because we are basing the color on a column, we put that information inside of <code>aes()</code> with <code>color = KnownSex</code>. We don’t put that inside <code>geom_point()</code>. This code looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-visualization.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-8-1.png" width="480" /></p>
<div id="assigning-plots" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Assigning plots</h3>
<p>When we make plots, our code can start to get quite long as we make more and more additions or changes to the plot. One very useful thing to know is that we can <em>assign</em> our plot to be an object, just as we would with a vector or a dataframe. For instance, let’s remake the plot above, but this time we’ll assign it the name <code>p</code>. We do that using <code>p &lt;-</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-visualization.html#cb10-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<p>Now, whenever we type and run <code>p</code> we will get our plot. e.g.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-visualization.html#cb11-1" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-10-1.png" width="480" /></p>
</div>
<div id="titles-and-axes-titles" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Titles and Axes Titles</h3>
<p>The advantage of assigning our plots to a short name, is that we can add things with less code. In R, if we wish to add a title to a plot, we do this with <code>+ ggtitle()</code>. So, here is how we add a title to our above plot:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-visualization.html#cb12-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Our first scatterplot&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-11-1.png" width="480" /></p>
<p>The above plot is basically the same as writing:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-visualization.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="data-visualization.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="data-visualization.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Our First Scatterplot&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-12-1.png" width="480" /></p>
<p>You’ll notice that we are <strong>chaining</strong> together commands with the <code>+</code>. This is similar to how we chain together commands with the <code>%&gt;%</code> when doing data carpentry. <code>ggplot()</code> instead chains with the <code>+</code>. Again, be careful not to start a row with a <code>+</code>, and you must end a row with a <code>+</code> unless it’s the very last row.</p>
<p>To change the title of the x-axis or the y-axis, we use <code>xlab</code> and <code>ylab</code> respectively. We can do it like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-visualization.html#cb14-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Body Mass (g)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Head Size (mm)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-13-1.png" width="480" /></p>
</div>
<div id="colors-shapes-and-sizes" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Colors, Shapes and Sizes</h3>
<p>R recognizes many default color names. These can be found at either of these places:</p>
<p><br>
<a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/">Color names 1</a>
<br>
<a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">Color names 2</a>
<br>
Or, you can use a <a href="https://htmlcolorcodes.com/color-picker/">hex code</a>
<br></p>
<p>Here we use the color <code>dodgerblue</code> to change all the points to that color:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-visualization.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-14-1.png" width="480" /></p>
<p>Here we change the points to the color <code>#ababcc</code> using a hexcode - note that hexcodes need to have <code>#</code> in front of them:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-visualization.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;#ababcc&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="480" /></p>
<p>You can also change the shape of the points you plot with <code>geom_point(pch = )</code>. You need to insert the appropriate number according to this guide:</p>
<p><img src="img/points.png" width="600" /></p>
<p>For example, to have dodgerblue asterisks, we add <code>pch = 8</code>, separating the color and shape commands by a comma:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-visualization.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-16-1.png" width="480" /></p>
<p>Finally, we can change the size of our datapoints (or other shape we choose), using <code>size =</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-visualization.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;purple&quot;</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-17-1.png" width="480" /></p>
</div>
<div id="themes" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Themes</h3>
<p><strong>Default Themes</strong></p>
<p>You may have noticed that every plot we have made so far has the same gray background with faint white gridlines. This is the default setting for the look of <code>ggplot()</code> graphs. There are several other <code>themes</code> that are available to us that change the overall appearance of our plots. Some of these are listed below:</p>
<p><code>theme_bw()</code>
a variation on theme_grey() that uses a white background and thin grey grid lines.</p>
<p><code>theme_linedraw()</code>
A theme with only black lines of various widths on white backgrounds, reminiscent of a line drawing.</p>
<p><code>theme_light()</code>
similar to theme_linedraw() but with light grey lines and axes, to direct more attention towards the data.</p>
<p><code>theme_dark()</code>
the dark cousin of theme_light(), with similar line sizes but a dark background. Useful to make thin colored lines pop out.</p>
<p><code>theme_minimal()</code>
A minimalistic theme with no background annotations.</p>
<p><code>theme_classic()</code>
A classic-looking theme, with x and y axis lines and no gridlines.</p>
<p><code>theme_void()</code>
A completely empty theme</p>
<p>Let’s shows a couple of these different themes. The theme that we use the most in this course is <code>theme_classic()</code>. This is how you would apply this theme to your plot:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-visualization.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="data-visualization.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="data-visualization.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-18-1.png" width="480" /></p>
<p>It creates a very sleek simple graph. The downside to this type of graph is that it does get rid of the gridlines which can be helpful sometimes.</p>
<p>Another theme that we use often is <code>theme_minimal()</code>. Here is how we would add this:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-visualization.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="data-visualization.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="data-visualization.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-19-1.png" width="480" /></p>
<p>This theme is also simplistic, but has gridlines too.</p>
<p><br></p>
<p><strong>Custom themes</strong></p>
<p>Rather than changing many different aspects of the graph at once, we can change individual things one by one with <code>theme()</code>. We don’t propose to cover this in more detail in this book - for more information about themes <a href="https://ggplot2-book.org/">look here</a> - however, here is one quick example.</p>
<p>Let’s say we wanted to make the panel background light blue instead of gray. We could do it like this:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-visualization.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head) ) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="data-visualization.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="data-visualization.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="480" /></p>
<p>Again, this can get quite complicated - so stick with the default themes if you want to change your plots up a bit, or go to other help guides for more fine detail on customization.</p>
<p><br><br></p>
</div>
</div>
<div id="histograms" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Histograms</h2>
<p>Histograms are very common data visualizations. Histograms plot the frequency on the y-axis of a continuous variable on the x-axis. For instance, let’s say we had the following data, that we’ll call <code>d1</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-visualization.html#cb22-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">vals =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb22-2"><a href="data-visualization.html#cb22-2" aria-hidden="true" tabindex="-1"></a>d1</span></code></pre></div>
<pre><code>##    vals
## 1     1
## 2     3
## 3     4
## 4     3
## 5     6
## 6     7
## 7     2
## 8     9
## 9     3
## 10    2
## 11    2
## 12    3
## 13    1
## 14    5
## 15    4
## 16    4</code></pre>
<p>If we wanted to know how many of each number in the column vals we have, we could use <code>table()</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-visualization.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d1<span class="sc">$</span>vals)</span></code></pre></div>
<pre><code>## 
## 1 2 3 4 5 6 7 9 
## 2 3 4 3 1 1 1 1</code></pre>
<p>The table above represents the <strong>frequency table</strong> or <strong>frequency count</strong> of the data. We can plot these data like this:</p>
<p><img src="img/hist1.png" /></p>
<p>In this histogram, the height of each bar represents the total amount of the number on the x-axis. So, the height of the bar at <code>x=9</code> is one. This mean we have 1 of this value in our data distribution. The height of the bar at <code>x=3</code> is four, therefore we have four in our distribution for the value 3.</p>
<p>In the example above, the width of the bars is precisely 1. We could change the width to say two. This is illustrated below:</p>
<p><img src="img/hist2.png" /></p>
<p>Here, the first bar is at height 9. It spans the values of x between 1-3. The second bar is at height 4, this include values between 3.01-5, and so on. What we did here was to adjust the <code>binwidth</code>. When we have large distributions, adjusting the binwidth helps us to interpret the data more easily.</p>
<div id="histograms-with-ggplot2" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Histograms with ggplot2</h3>
<p>To describe how to make histograms with the <code>ggplot()</code> function, lets look at the <code>films.csv</code> dataset.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-visualization.html#cb26-1" aria-hidden="true" tabindex="-1"></a>film <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/films.csv&quot;</span>)</span>
<span id="cb26-2"><a href="data-visualization.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="data-visualization.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(film)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   film                     year rottentomatoes  imdb metacritic
##   &lt;chr&gt;                   &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 Avengers: Age of Ultron  2015             74   7.8         66
## 2 Cinderella               2015             85   7.1         67
## 3 Ant-Man                  2015             80   7.8         64
## 4 Do You Believe?          2015             18   5.4         22
## 5 Hot Tub Time Machine 2   2015             14   5.1         29
## 6 The Water Diviner        2015             63   7.2         50</code></pre>
<p>This dataset contains 146 rows of data. Each row has a unique film, with the final three columns giving three different ratings measures of how good the film was. These are their respective <code>rottentomatoes</code>, <code>imdb</code> and <code>metacritic</code> scores.</p>
<p>If we wished to plot the distribution of <code>imdb</code> scores, we need to put <code>x=imdb</code> inside the <code>aes()</code> part of the ggplot code. That is to tell it to plot these scores on the x-axis. We do not need to put a <code>y=</code> inside this, as we are not plotting anything from our dataset on the y-axis. Instead, ggplot2 will count up the frequency of our scores between regular intervals of <code>imdb</code> scores.</p>
<p>We then add <code>+ geom_histogram()</code> to tell it to make a histogram. All together it looks like this:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-visualization.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x=</span>imdb)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="data-visualization.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()  </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-24-1.png" width="480" /></p>
<p>Now, this doesn’t look great and we have several problems with it. The two major problems that we get with our first histograms are. 1) The binwidth is almost never appropriate. We need to tell ggplot exactly what we want the binwidth on the x-axis to be. That is, what interval do we want our scores to be counted over. Looking at the graph, our scores range from just below 4 to about 8.6. Perhaps a better interval would be 0.2, so we count how many films had scores between 3.6-3.8, 3.8-4.0, 4.0-4.2, 4.2-4.4, …….. 8.4-8.6, 8.6-8.8 etc. 2) Having black bars makes it really hard to distinguish the bars when they are close in heights. We need to fix the color scheme.</p>
<p>OK, let’s make the bars dodgerblue and border them white. Inside <code>geom_histogram()</code> we use <code>color="white"</code> to represent the outside <em>lines</em> of the bars. We use <code>fill="dodgerblue</code> to indicate the color inside the bars should be dodgerblue.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-visualization.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x=</span>imdb)) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="data-visualization.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;dodgerblue&quot;</span>) </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="480" /></p>
<p>Now let’s fix that binwidth. To resolve this, inside <code>geom_histogram()</code> we write <code>binwidth = 0.2</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-visualization.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x =</span> imdb)) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="data-visualization.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;dodgerblue&quot;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="480" /></p>
<p>This looks a lot better. Now we can see that the majority of films have ratings in the 6.2-7.8 range, with relatively few above 8 and below 5. It’s not always easy to know what size interval to choose for the x-axis in histograms. It’s worth just playing around with that number and seeing how it looks.</p>
<p>When we set the interval to be some value - here, we chose 0.2 - R doesn’t automatically make that between easy to interpret numbers such as 4.0-4.2, 4.2-4.4 etc. It could just as easily have chosen 3.874-4.074, 4.074-4.274. Obviously, the latter is hard for us to interpret when looking at the axes. You can see in the above plot, that the vertical lines of the histogram bars don’t neatly fall on top of whole numbers. To fix, this you can adjust the boundaries by picking a value to center your interval on. So, if we pick <code>boundary=4</code>, then that will be a boundary marker, and the interval will go 4.0-4.2, 4.2-4.4 etc.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-visualization.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x =</span> imdb)) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="data-visualization.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;dodgerblue&quot;</span>,<span class="at">boundary=</span><span class="dv">4</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-27-1.png" width="480" /></p>
<p>Just be careful with using the boundaries that it does not crop your histogram incorrectly. Changing histograms too much can lead to misrepresenting the data. We would recommend that you don’t use the boundary feature unless you have a real need to do so - just be careful!</p>
<p>Like with all ggplot figures, you can add as much customization as you wish. Here, we add a new theme, title and x- and y-axis labels:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-visualization.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x =</span> imdb)) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="data-visualization.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="data-visualization.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="data-visualization.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Histogram of IMDB Ratings&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="data-visualization.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="data-visualization.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-28-1.png" width="480" /></p>
<p>This looks really nice !</p>
<p><br><br><br></p>
</div>
<div id="density-curves" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Density Curves</h3>
<p>Instead of plotting the <strong>frequency</strong> or counts of values on the y-axis, we can instead plot <strong>density</strong>. Here, we essentially convert the histogram to a solid line that estimates the overall shape of the distribution. We call this line a density curve. You can make this plot using <code>ggplot()</code> using <code>+ geom_density()</code> instead of <code>+ geom_histogram()</code>.</p>
<p>In the code below we do this for the <code>imdb</code> ratings, and we make the line color navy, and the fill of the density curve dodgerblue:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-visualization.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x =</span> imdb)) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="data-visualization.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;dodgerblue&quot;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="480" /></p>
<p>Usually the fill of these plots is too much, so it’s nice to add some transparency. You can do that by picking a number between 0 and 1 to provide to the <code>alpha</code> argument. Here we choose <code>alpha = .4</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-visualization.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(film, <span class="fu">aes</span>(<span class="at">x =</span> imdb)) <span class="sc">+</span>  </span>
<span id="cb36-2"><a href="data-visualization.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">alpha=</span>.<span class="dv">4</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-30-1.png" width="480" /></p>
<p>The useful thing about density plots is that they give you a quick visual aid as to the overall shape of the distribution. You can easily see where the bulk of the data lie (here between 6 and 8 ratings score), and whether the data is symmetrical or not.</p>
<p><br></p>
</div>
<div id="comparing-distributions" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Comparing Distributions</h3>
<p>Instead of just plotting one histogram or one density curve, we often are interested in comparing two or more distributions. This means we are interested in comparing two or more histograms or density curves. To do this, we first need to ensure that our data are all measured in the same units.</p>
<p><br></p>
<p><strong>Overlaid Histograms</strong></p>
<p>To illustrate this, let’s use the <code>lifeexp.csv</code> data which contains life expectancy data for many countries.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-visualization.html#cb37-1" aria-hidden="true" tabindex="-1"></a>life <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/lifeexp.csv&quot;</span>)</span>
<span id="cb37-2"><a href="data-visualization.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="data-visualization.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   country     continent year      lifeExp      pop gdpPercap
##   &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 Afghanistan Asia      year_1952    28.8  8425333      779.
## 2 Afghanistan Asia      year_2007    43.8 31889923      975.
## 3 Albania     Europe    year_1952    55.2  1282697     1601.
## 4 Albania     Europe    year_2007    76.4  3600523     5937.
## 5 Algeria     Africa    year_1952    43.1  9279525     2449.
## 6 Algeria     Africa    year_2007    72.3 33333216     6223.</code></pre>
<p>You can see that one of the columns is called <code>lifeExp</code> which is the life expectancy of each country in either 1952 or 2007. The year is shown in the <code>year</code> column, and the country is shown in the <code>country</code> column. You’ll notice that these data are in long format (see section <a href="#wide-versus-long-data"><strong>??</strong></a>).</p>
<p>Perhaps we are interested in the distribution of life expectancies across all countries in the year 1952 compared to the distribution of life expectancies in the year 2007. We have a few options to do this.</p>
<p>The first option does not look good for this example (although it may work in other situations). This is an <strong>overlaid histogram</strong>. To do this, inside <code>aes()</code> as well as saying which column our distribution data is in <code>x=lifeExp</code>, we also tell it to make separate histograms based on the year column with <code>fill=year</code>. This will ensure it uses different fill colors for the two different years. Although not necessary, putting <code>position="identity"</code> inside <code>geom_histogram()</code> helps make the plot a little nicer. Putting <code>color="black"</code> and <code>alpha=.7</code> inside <code>geom_histogram()</code> also helps distinguish the two histograms.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-visualization.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(life, <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, <span class="at">fill=</span>year)) <span class="sc">+</span>  </span>
<span id="cb39-2"><a href="data-visualization.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">2</span>, <span class="at">position=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">alpha=</span>.<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="data-visualization.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-32-1.png" width="480" /></p>
<p>This plot is still pretty bad though. This method of plotting is better when the histograms are quite distinctive from one another and there isn’t much overlap in the distributions.</p>
<p>Choosing two colors that contrast more strongly than the default colors can help. Here, we are using hexcodes to pick a gray and a mustard yellow color. We manually define our fill colors using <code>+  scale_fill_manual(values = c("#999999", "#E69F00"))</code>. To change the colors, just change the hexcodes to different ones or the names of colors you’d like. Just make sure that you have the same number of colors as groups in your data. Here, we have two groups (1952 and 2007) so we need two colors. Also, notice that it says <code>scale_fill_manual</code> and not <code>scale_color_manual</code>. Because we are dealing with the inside color - this is considered to be a <strong>fill</strong> in ggplot2 terms. We used <code>fill=year</code> inside <code>aes()</code> so we need to match that with <code>fill</code> when manually choosing colors.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data-visualization.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(life, <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, <span class="at">fill=</span>year)) <span class="sc">+</span>  </span>
<span id="cb40-2"><a href="data-visualization.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>( <span class="at">binwidth=</span><span class="dv">2</span>, <span class="at">position=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">alpha=</span>.<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="data-visualization.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="data-visualization.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-33-1.png" width="480" /></p>
<p><strong>Overlaid Density Plots</strong></p>
<p>Comparing distributions can also be done with <code>geom_density</code>. This is usually simpler to compare than overlaid histograms.</p>
<p>The default plot for this would be to include <code>fill=year</code> inside the <code>aes()</code> code, as the <code>year</code> column contains the data that we wish to make separate plots for.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-visualization.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(life, <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, <span class="at">fill=</span>year)) <span class="sc">+</span>  </span>
<span id="cb41-2"><a href="data-visualization.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-34-1.png" width="480" /></p>
<p>We can add a custom fill colors with <code>+ scale_fill_manual(values = c("#999999", "#E69F00"))</code> and a custom theme with <code>+ theme_classic()</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-visualization.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(life, <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, <span class="at">fill=</span>year)) <span class="sc">+</span>  </span>
<span id="cb42-2"><a href="data-visualization.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> year), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="data-visualization.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>))  <span class="sc">+</span> </span>
<span id="cb42-4"><a href="data-visualization.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-35-1.png" width="480" /></p>
<p>This plot is now very easy to interpret. It’s clear that in 2007 most countries had life expectancies of over 70, with a tail towards younger life expectancies. In 1952, the opposite pattern is found with most countries having life expectancies around 40 with the tail going towards older countries.</p>
</div>
<div id="stem-and-leaf-plots" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Stem-and-Leaf Plots</h3>
<p>Stem-and-leaf plots are a simplistic version of histograms. Before the advent of computers, this kind of plot would sometimes be easier to make than a histogram. Their heyday was quite a few decades ago! In fact, nowadays, these types of plots are almost never made by researchers or data scientists in the real world. They are pretty much exclusive to introductory statistics courses. This is a bit of a shame because we think they are pretty cute.</p>
<p>Here is an example. Imagine we have the following numbers in a distribution. They may represent temperatures:</p>
<p><code>20, 20, 23, 28, 29, 31, 32, 39, 40, 41, 42, 44, 44, 45, 48, 49, 55, 55, 56, 58, 59, 61, 62, 65, 66, 67, 70, 71, 75, 82, 86</code></p>
<p>We can represent these in a stem-and-leaf plot as below. The first column represents the “tens” and the second column represents the “ones”. So the “6” in the last row in the second column represents a temperature of 86. We put the second column data in ascending order. The heights of these bars represent a kind of histogram of sorts.</p>
<p><img src="img/sl1.png" /></p>
<p>The columns do not have to be tens and ones. For instance, if our data had been seconds, and the distribution was <code>2.0, 2.0, 2.3, 2.8....... 7.5, 8.2, 8.6</code> we could have done the same stem-and-leaf plot.</p>
<p>There isn’t a simple ggplot way of making stem-and-leaf plots, but there is a built-in function called <code>stem()</code> that can make them.</p>
<p>For an example, if we return to our imdb ratings:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-visualization.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(film)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   film                     year rottentomatoes  imdb metacritic
##   &lt;chr&gt;                   &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 Avengers: Age of Ultron  2015             74   7.8         66
## 2 Cinderella               2015             85   7.1         67
## 3 Ant-Man                  2015             80   7.8         64
## 4 Do You Believe?          2015             18   5.4         22
## 5 Hot Tub Time Machine 2   2015             14   5.1         29
## 6 The Water Diviner        2015             63   7.2         50</code></pre>
<p>We can make a stem-and-leaf plot of the <code>imdb</code> column like this. The <code>scale=0.6</code> parameter dictates how long the stem-and-leaf plot should be. You can adjust it to your liking. Lower numbers make the plot shorter:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-visualization.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stem</span>(film<span class="sc">$</span>imdb, <span class="at">scale=</span><span class="fl">0.6</span>)</span></code></pre></div>
<pre><code>## 
##   The decimal point is at the |
## 
##   4 | 0234
##   4 | 6699
##   5 | 01224444
##   5 | 555556678999
##   6 | 0011112333333333444444
##   6 | 5555666666666777777789999999
##   7 | 0000111111122222222223333344444444
##   7 | 555555666777788888888899
##   8 | 012222344
##   8 | 6</code></pre>
<p>Here, the lowest rating we have is 4.0, and the highest is 8.6.</p>
<p><br><br><br></p>
</div>
</div>
<div id="scatterplots" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Scatterplots</h2>
<p>In the introduction to <code>ggplot2</code>, we already demonstrated how to make a scatterplot. Here we will show a few extra features of these plots. Scatterplots plot continuous variables on the x- and y-axes, and can be very useful to examine the association between the two continuous variables. We use them a lot when plotting data related to correlation (see section <a href="#correlation"><strong>??</strong></a>) or regression (see section <a href="#linear-regression"><strong>??</strong></a>).</p>
<p>As we showed earlier, <code>geom_point</code> is used to add datapoints to scatter plots. We’ll do this for the <code>cheese.csv</code> dataset, that contains nutritional information about various cheeses:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-visualization.html#cb47-1" aria-hidden="true" tabindex="-1"></a>cheese <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/cheese.csv&quot;</span>)</span>
<span id="cb47-2"><a href="data-visualization.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cheese)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   type      sat_fat polysat_fat monosat_fat protein  carb  chol fiber  kcal
##   &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 blue         18.7       0.8          7.78    21.4  2.34    75     0   353
## 2 brick        18.8       0.784        8.60    23.2  2.79    94     0   371
## 3 brie         17.4       0.826        8.01    20.8  0.45   100     0   334
## 4 camembert    15.3       0.724        7.02    19.8  0.46    72     0   300
## 5 caraway      18.6       0.83         8.28    25.2  3.06    93     0   376
## 6 cheddar      21.1       0.942        9.39    24.9  1.28   105     0   403</code></pre>
<p>We’ll start with a simple scatterplot looking at the association between saturated fat on the x-axis and cholesterol on the y-axis intake.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-visualization.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="data-visualization.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-1.png" width="480" /></p>
<p>We can change the color of the points by adding a color inside of <code>geom_point</code> - making sure that the color name is in quotes:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="data-visualization.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="data-visualization.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-40-1.png" width="480" /></p>
<p>To add a straight trendline through the data we use <code>+ stat_smooth(method = "lm")</code>. The <code>stat_smooth</code> bit tells it to add a trendline, and the <code>method="lm"</code> bit in the middle is telling it to make the straight line:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-visualization.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="data-visualization.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="data-visualization.html#cb51-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-41-1.png" width="480" />
Here you can see it automatically puts a shaded area around your trendline, which represents a confidence interval around the trendline. There is a way to remove it by adding <code>se = FALSE</code> or <code>se = F</code> inside of <code>stat_smooth()</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="data-visualization.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb52-2"><a href="data-visualization.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-3"><a href="data-visualization.html#cb52-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-42-1.png" width="480" /></p>
<p>You can also change the color of the trendline, by adding to <code>stat_smooth</code></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data-visualization.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb53-2"><a href="data-visualization.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="data-visualization.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span> F, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="480" /></p>
<p>As with all <code>ggplot2</code> graphs, you can customize the plot. For example changing the theme, adding a title and axes titles:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data-visualization.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x=</span>sat_fat, <span class="at">y=</span>chol) ) <span class="sc">+</span> </span>
<span id="cb54-2"><a href="data-visualization.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="data-visualization.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span> F, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="data-visualization.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot; Saturated Fat&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="data-visualization.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="data-visualization.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Saturated Fat vs Cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="data-visualization.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="480" /></p>
<p>If you wish to change the color of the points based on a grouping variable, then we need to put our <code>color=</code> into the <code>aes()</code>. You then need to provide the column that has the color grouping variable. For example, to change the color of points in our plot of body mass against head size in Blue Jays based on the sex of birds:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data-visualization.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##   BirdID     KnownSex BillDepth BillWidth BillLength  Head  Mass Skull   Sex
##   &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0000-00000 M             8.26      9.21       25.9  56.6  73.3  30.7     1
## 2 1142-05901 M             8.54      8.76       25.0  56.4  75.1  31.4     1
## 3 1142-05905 M             8.39      8.78       26.1  57.3  70.2  31.2     1
## 4 1142-05907 F             7.78      9.3        23.5  53.8  65.5  30.3     0
## 5 1142-05909 M             8.71      9.84       25.5  57.3  74.9  31.8     1
## 6 1142-05911 F             7.28      9.3        22.2  52.2  63.9  30       0</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data-visualization.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> </span>
<span id="cb57-2"><a href="data-visualization.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-45-1.png" width="480" /></p>
<p>If you wish to customize the colors of your datapoints, then you need to add <code>scale_color_manual()</code> like this:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="data-visualization.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> </span>
<span id="cb58-2"><a href="data-visualization.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-3"><a href="data-visualization.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="data-visualization.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-46-1.png" width="480" /></p>
<p>If you have a lot of points on your scatterplot, it can get quite hard to see all the datapoints. One way to deal with this is to change the <strong>transparency</strong> of the points. You can do this by adjusting the <code>alpha</code> level inside of <code>geom_point()</code>. <code>alpha=</code> ranges from 0 to 1, with 0 being fully transparent and 1 being fully solid.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-visualization.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex) ) <span class="sc">+</span> </span>
<span id="cb59-2"><a href="data-visualization.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb59-3"><a href="data-visualization.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="data-visualization.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-47-1.png" width="480" /></p>
<div id="multiple-groups-on-a-scatterplot" class="section level4" number="4.3.0.1">
<h4><span class="header-section-number">4.3.0.1</span> Multiple Groups on a Scatterplot</h4>
<p>We can add multiple trendlines to each group of datapoints plotted on a scatterplot. Let’s look at the following data of the chemical components of different olive oils produced in Italy. This is what the data look like:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="data-visualization.html#cb60-1" aria-hidden="true" tabindex="-1"></a>olives <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/olives.csv&quot;</span>)</span>
<span id="cb60-2"><a href="data-visualization.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(olives)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 10
##   macro.area region       palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic
##   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 South      Apulia.north     1075          75     226  7823      672        36        60         29
## 2 South      Apulia.north     1088          73     224  7709      781        31        61         29
## 3 South      Apulia.north      911          54     246  8113      549        31        63         29
## 4 South      Apulia.north      966          57     240  7952      619        50        78         35
## 5 South      Apulia.north     1051          67     259  7771      672        50        80         46
## 6 South      Apulia.north      911          49     268  7924      678        51        70         44</code></pre>
<p>If we use <code>table()</code>, we can see how many different regions are represented in the data. There are three unique Italian areas where the olives come from:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="data-visualization.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(olives<span class="sc">$</span>macro.area)</span></code></pre></div>
<pre><code>## 
## Centre.North     Sardinia        South 
##          151           98          323</code></pre>
<p>Say we are interested in looking at how <code>oleic</code> and <code>linoleic</code> acid contents are related to each other by <code>macro.area</code>:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="data-visualization.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x=</span>oleic, <span class="at">y=</span>linoleic, <span class="at">color=</span>macro.area)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="data-visualization.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-3"><a href="data-visualization.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="480" />
<br></p>
<p>If we wanted to add a trendline for each area, all we need to do is add our <code>stat_smooth(method="lm)</code> line to the code. It already knows to plot these as separate trendlines for each group because inside <code>aes()</code> we have <code>color=macro.area</code>. As long as there is a <code>group=</code> or <code>color=</code> inside <code>aes()</code> then it knows to do things like adding trendlines separately for each group:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="data-visualization.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x=</span>oleic, <span class="at">y=</span>linoleic, <span class="at">color=</span>macro.area)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="data-visualization.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-3"><a href="data-visualization.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb65-4"><a href="data-visualization.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-51-1.png" width="480" /></p>
<p><br></p>
</div>
<div id="bubble-charts" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Bubble Charts</h3>
<p>Bubble Charts are an extension to scatterplots. In scatterplots we plot two continuous variables against each other. With a bubble chart we add a third continuous variable and vary the size of our datapoints according to this variable. For example, say we wish to also plot skull size on our Blue Jay scatterplot. We could increase the size of the points for individuals with larger skull sizes. We do this by adding <code>size=Skull</code> into our <code>aes()</code> part:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="data-visualization.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex, <span class="at">size =</span> Skull) ) <span class="sc">+</span> </span>
<span id="cb66-2"><a href="data-visualization.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="data-visualization.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="data-visualization.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-52-1.png" width="480" /></p>
<p>The issue with bubble charts is that they can start to look very cluttered, making it hard to actually see any patterns. They should probably be used sparingly. One trick you can employ to make them a little easier to see is to add <code>scale_size()</code> to the plot. Here, you enter two numbers to tell it what size points to scale to. In our example below, we used <code>scale_size(range = c(.1, 4))</code> which makes our points range between sizes 0.1 and 4. This makes the plot a little less busy:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data-visualization.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Mass, <span class="at">y=</span>Head, <span class="at">color =</span> KnownSex, <span class="at">size =</span> Skull) ) <span class="sc">+</span> </span>
<span id="cb67-2"><a href="data-visualization.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb67-3"><a href="data-visualization.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb67-4"><a href="data-visualization.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb67-5"><a href="data-visualization.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-53-1.png" width="480" /></p>
<p><br><br><br></p>
</div>
</div>
<div id="line-graphs" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Line Graphs</h2>
<p>Line graphs connect continuous values on the y-axis over time on the x-axis. They are very useful for show patterns of change over time.</p>
<p>Let’s look at the <code>jennifer.csv</code> dataset:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data-visualization.html#cb68-1" aria-hidden="true" tabindex="-1"></a>jennifer <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/jennifer.csv&quot;</span>)</span>
<span id="cb68-2"><a href="data-visualization.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="data-visualization.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jennifer)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year sex    name         n       prop
##   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;
## 1  1916 Female Jennifer     5 0.00000461
## 2  1919 Female Jennifer     6 0.00000511
## 3  1920 Female Jennifer     7 0.00000563
## 4  1921 Female Jennifer     5 0.00000391
## 5  1922 Female Jennifer     7 0.00000561
## 6  1923 Female Jennifer     9 0.00000719</code></pre>
<p>This dataset shows the number <code>n</code> of children born each year (<code>year</code>) in the United States with the name Jennifer. In 1916 there were five children born with the name Jennifer. In 1917 there were 0. In 1923 there were 9.</p>
<p>This dataset goes up to 2017 where there were 1052 children born with the name Jennifer:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data-visualization.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(jennifer)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year sex    name         n     prop
##   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1  2012 Female Jennifer  1923 0.000993
## 2  2013 Female Jennifer  1689 0.000878
## 3  2014 Female Jennifer  1521 0.000779
## 4  2015 Female Jennifer  1283 0.000660
## 5  2016 Female Jennifer  1159 0.000601
## 6  2017 Female Jennifer  1042 0.000556</code></pre>
<p>Therefore, we have a continuous variable (<code>n</code>) and a time variable (<code>year</code>). We can plot these as we would plot a scatterplot by supplying <code>year</code> to our x-axis and <code>n</code> to our y-axis. We could then add datapoints with <code>geom_point()</code> essentially making a scatterplot:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="data-visualization.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-56-1.png" width="480" /></p>
<p>But, we aren’t dealing with just a scatterplot. These datapoints can be connected to each other as they are ordered in time. Instead of using <code>geom_point()</code> we can use <code>geom_line()</code> to draw a line instead:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="data-visualization.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-57-1.png" width="480" /></p>
<p>If you so desired, you could plot both the points and lines together:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="data-visualization.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> </span>
<span id="cb74-2"><a href="data-visualization.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb74-3"><a href="data-visualization.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-58-1.png" width="480" /></p>
<p>You can adjust the colors of the lines and the points independently by supplying <code>color=</code> inside of each geom:</p>
<p>e.g. Changing the color of the line, but <em>not</em> the points:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="data-visualization.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> </span>
<span id="cb75-2"><a href="data-visualization.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="data-visualization.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-59-1.png" width="480" /></p>
<p>Changing the color of both the points and the line:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="data-visualization.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> </span>
<span id="cb76-2"><a href="data-visualization.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;violet&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="data-visualization.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-60-1.png" width="480" /></p>
<p>You can also change the width of lines by adding <code>lwd=</code> to <code>geom_line()</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="data-visualization.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> </span>
<span id="cb77-2"><a href="data-visualization.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-61-1.png" width="480" /></p>
<p>There are also several different styles of lines. You can change these by adjusting the number you provide to <code>lty=</code> inside of <code>geom_line()</code>. Here are a few examples:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data-visualization.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-62-1.png" width="288" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="data-visualization.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jennifer, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n) ) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-63-1.png" width="288" /></p>
<p>This illustration shows some of the linetype options:</p>
<p><img src="img/lty.png" /></p>
<p>Just a quick reminder: Please only connect datapoints into a line if it is meaningful to do so! This is almost always when your x-axis is some measure of time.</p>
<p><br></p>
<div id="multiple-line-graphs" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Multiple Line Graphs</h3>
<p>Often we wish to compare the patterns over time of different groups. We can do that by plotting <em>multiple</em> lines on the same graph.</p>
<p>Let’s look at this example dataset.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data-visualization.html#cb80-1" aria-hidden="true" tabindex="-1"></a>jenlinda <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/jenlinda.csv&quot;</span>)</span>
<span id="cb80-2"><a href="data-visualization.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="data-visualization.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(jenlinda)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year sex    name         n     prop
##   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1  2015 Female Jennifer  1283 0.000660
## 2  2015 Female Linda      425 0.000218
## 3  2016 Female Jennifer  1159 0.000601
## 4  2016 Female Linda      436 0.000226
## 5  2017 Female Jennifer  1042 0.000556
## 6  2017 Female Linda      404 0.000215</code></pre>
<p>Here, we have data in <strong>long</strong> format. We still have our continuous outcome variable of <code>n</code> in one column. We also have <code>year</code> in another column. So we can plot these two against each other. Importantly, we can split our lines based on our grouping variable, which is the <code>name</code> column. In that column we have two different groups - Jennifer and Linda.</p>
<p>To plot separate lines based on the <code>name</code> column, we need to add <code>group=name</code> to our <code>aes()</code>. We’ve also added some custom labels, titles and a theme.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data-visualization.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jenlinda, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">group=</span>name)) <span class="sc">+</span> </span>
<span id="cb82-2"><a href="data-visualization.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb82-3"><a href="data-visualization.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-4"><a href="data-visualization.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Children Born&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-5"><a href="data-visualization.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of Names Jennifer &amp; Linda in USA&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="data-visualization.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-65-1.png" width="480" /></p>
<p>You may notice that both lines are the same color! To make the lines have different colors, we insert <code>color=name</code> into the <code>aes()</code> instead of <code>group=name</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="data-visualization.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jenlinda, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">color=</span>name)) <span class="sc">+</span> </span>
<span id="cb83-2"><a href="data-visualization.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb83-3"><a href="data-visualization.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-4"><a href="data-visualization.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Children Born&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-5"><a href="data-visualization.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of Names Jennifer &amp; Linda in USA&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-6"><a href="data-visualization.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-1.png" width="480" /></p>
<p>Again, we could customize these colors if we did not like them with <code>scale_color_manual()</code> like this:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data-visualization.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jenlinda, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>n, <span class="at">color=</span>name)) <span class="sc">+</span> </span>
<span id="cb84-2"><a href="data-visualization.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb84-3"><a href="data-visualization.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="data-visualization.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Children Born&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-5"><a href="data-visualization.html#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of Names Jennifer &amp; Linda in USA&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-6"><a href="data-visualization.html#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb84-7"><a href="data-visualization.html#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#ffadf3&quot;</span>, <span class="st">&quot;#800f4f&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-67-1.png" width="480" /></p>
<p>Just insert your favorite colors, and make sure you provide the same number of colors as you have separate groups/lines.</p>
<p><br><br><br></p>
</div>
</div>
<div id="comparing-distributions-across-groups" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Comparing Distributions across Groups</h2>
<p>One of the most important data visualizations that we make is to compare the distribution of data across groups. Here we have a categorical variable on the x-axis, and a continuous variable on the y-axis. For some reason, the most common way to represent these data in most of the scientific literature is to plot bar graphs with error bars - so-called dynamite plots. However, in our very strong opinion these plots are dreadful and you should never use them. <a href="http://biostat.mc.vanderbilt.edu/wiki/pub/Main/TatsukiRcode/Poster3.pdf">Fortunately others agree</a>. Instead, please choose from strip plots, boxplots or violin plots, or a combination, depending upon your data.</p>
<p>In this section we’ll use the <code>wheels1.csv</code> dataset. These data show the number of revolutions of a running wheel made by mice over a four day period. The mice vary by their strain (type). Here we just select the <code>id</code>, <code>strain</code> and <code>day4</code> columns for this example:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data-visualization.html#cb85-1" aria-hidden="true" tabindex="-1"></a>wheels <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wheels1.csv&quot;</span>)</span>
<span id="cb85-2"><a href="data-visualization.html#cb85-2" aria-hidden="true" tabindex="-1"></a>wheels1 <span class="ot">&lt;-</span> wheels <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, strain, day4) </span>
<span id="cb85-3"><a href="data-visualization.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wheels1)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   id    strain   day4
##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1 692ao B6     12516.
## 2 656aa B6      7404.
## 3 675ag B6      3761 
## 4 675ai B6     11684 
## 5 656af B6      8468.
## 6 656al B6      9291</code></pre>
<p>The <code>day4</code> column represents how many wheel revolutions the mice made on their fourth day running in the wheel. Some mice really like running in the wheel, others aren’t as bothered!</p>
<p>Let’s have a look at how many datapoints we have in each strain:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="data-visualization.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wheels<span class="sc">$</span>strain)</span></code></pre></div>
<pre><code>## 
##       B6 F1-129B6 F1-B6129     S129    Swiss 
##       14       22       15       16       13</code></pre>
<p>We have 80 mice in five different strains.</p>
<p><br></p>
<div id="strip-plots" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Strip Plots</h3>
<p>Strip plots essentially just plot the raw data. It’s like plotting a scatterplot, except we plot a categorical variable on the x-axis.</p>
<p>So in our example, inside <code>aes()</code> we’ll put strain on the x-axis with <code>x=strain</code>, and on the y-axis we put our outcome variable with <code>y=day4</code>. We’ll add datapoints with <code>+ geom_point()</code>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="data-visualization.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="data-visualization.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb89-3"><a href="data-visualization.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-70-1.png" width="480" /></p>
<p>The major issue with this plot is that all the points are in a very straight line, and it can be difficult to distinguish between different points. To change this, instead of using <code>geom_point()</code> we use <code>geom_jitter()</code> which bounces the points around a bit:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data-visualization.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="data-visualization.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()  <span class="sc">+</span></span>
<span id="cb90-3"><a href="data-visualization.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-71-1.png" width="480" /></p>
<p>Whoops! The points exploded. Now it’s not possible to know which points belong to which group. To constrain this, we can set <code>width=</code> inside of <code>geom_jitter()</code> which tells the points how far they are allowed to bounce around:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="data-visualization.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="data-visualization.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">15</span>)  <span class="sc">+</span></span>
<span id="cb91-3"><a href="data-visualization.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-72-1.png" width="480" /></p>
<p>This looks a lot better!.</p>
<p><br></p>
</div>
<div id="boxplots" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Boxplots</h3>
<p>Boxplots are a very useful way of summarizing the distribution of data. The image below summarizes what each line in the boxplot represents. For more details on all of these descriptive measures see section <a href="#descriptives"><strong>??</strong></a>:</p>
<p><img src="img/box2.png" /></p>
<p>The middle horizontal line is at 6. This represents the <strong>median</strong> of the distribution which is the middle value. 50% of the distribution lies above this value and 50% below it. The higher horizontal line at the top of the box represents the <strong>upper quartile</strong>. This is approximately the median of the upper 50% of the data, so is approximately the 75% percentile. The lower horizontal line at the bottom of the box represents the <strong>lower quartile</strong>. This is approximately the median of the lower 50% of the data, so is approximately the 25% percentile of the data. Therefore, the middle 50% of the data (from the 25% percentile to the 75% percentile) lies inside the box. The long vertical lines represent the <strong>range</strong> of the data. The top of that line is the maximum value in the data, and the bottom of that line is the minimum value in the distribution.</p>
<p>The above is a basic boxplot. However, <code>ggplot2</code> does things a little bit differently. It turns out there is more than one way to calculate the lower and upper quartiles (see section <a href="#interquartile-range"><strong>??</strong></a>). Also, R doesn’t necessarily extend the vertical lines (<strong>whiskers</strong>) all the way to the minimum and maximum values. If there are datapoints that are too far away from the upper or lower quartile, then it truncates the whisker and shows datapoints outside of this range as dots. Here is an illustration of a ggplot boxplot:</p>
<p><img src="img/box3.png" /></p>
<p>OK, let’s have a look at some boxplots using <code>ggplot()</code>. We provide the same <code>x=strain</code> and <code>y=day4</code> values as we do with strip plots. Instead of <code>geom_jitter()</code> we use <code>geom_boxplot()</code>:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="data-visualization.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="data-visualization.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()  <span class="sc">+</span></span>
<span id="cb92-3"><a href="data-visualization.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-73-1.png" width="480" /></p>
<p>You can see in this example, that the strain “F1-129B6” and the strain “S129” both have two datapoints that are shown as outliers beyond the whiskers.</p>
<p>To change the colors of the boxplots, you can change <code>color=</code> and <code>fill=</code> inside <code>geom_boxplot()</code>. Remember that <code>color</code> refers to the color of the lines, and <code>fill</code> refers to the filled in color of the shape:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="data-visualization.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="data-visualization.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-3"><a href="data-visualization.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-74-1.png" width="480" /></p>
<p>You can change the size, color and shape of the outliers. For instance, to remove them completely, we do <code>outlier.shape=NA</code> inside <code>geom_boxplot()</code></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="data-visualization.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="data-visualization.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="data-visualization.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-75-1.png" width="480" /></p>
<p>To change the size and color, you can use <code>outlier.size</code> and <code>outlier.color</code> respectively inside <code>geom_boxplot()</code></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="data-visualization.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="data-visualization.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.size =</span> .<span class="dv">5</span>, <span class="at">outlier.color =</span> <span class="st">&quot;gray66&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-3"><a href="data-visualization.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-76-1.png" width="480" /></p>
<p><br></p>
<div id="overlaying-points" class="section level4" number="4.5.2.1">
<h4><span class="header-section-number">4.5.2.1</span> Overlaying points</h4>
<p>It can often be helpful to overlay your raw datapoints over the top of boxplots, providing that you don’t have too much data. To do this, just add your points with either <code>geom_point()</code> or preferably <code>geom_jitter()</code>. But one warning - make sure you remove any outliers with <code>outlier.shape=NA</code> otherwise those datapoints will show up twice:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="data-visualization.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb96-2"><a href="data-visualization.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="data-visualization.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">&quot;navy&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="data-visualization.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-77-1.png" width="480" /></p>
<p>Sometimes this can look a bit too busy. One way to contrast things is to set either the points or the boxplots themselves to have some transparency with <code>alpha=</code>.</p>
<p>Here we make the points a bit transparent:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="data-visualization.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb97-2"><a href="data-visualization.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="data-visualization.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb97-4"><a href="data-visualization.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-78-1.png" width="480" /></p>
<p>Here we leave the points solid, but make the boxplot fill transparent:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="data-visualization.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="data-visualization.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb98-3"><a href="data-visualization.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">&quot;navy&quot;</span>) <span class="sc">+</span></span>
<span id="cb98-4"><a href="data-visualization.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-79-1.png" width="480" /></p>
<p>And finally, making both a bit transparent, adding some custom titles and labels. You can just choose what you think looks best!</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="data-visualization.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb99-2"><a href="data-visualization.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-3"><a href="data-visualization.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="data-visualization.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()  <span class="sc">+</span></span>
<span id="cb99-5"><a href="data-visualization.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="data-visualization.html#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-7"><a href="data-visualization.html#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-80-1.png" width="480" /></p>
<p><br></p>
</div>
<div id="reordering-categorical-x-axes" class="section level4" number="4.5.2.2">
<h4><span class="header-section-number">4.5.2.2</span> Reordering categorical x-axes</h4>
<p>The boxplot that we made looks ok, but one thing is visually annoying. The boxes are plotted in alphabetical order on the x-axis (B6, F1-129B6….. Swiss). There is no reason why they should be in this order. A more visually appealing way would be to order the boxplots from the group with the highest median to the lowest median.</p>
<p>To do this, instead of putting <code>x=strain</code> inside of <code>aes()</code> we put <code>x = reorder(strain, -day4, median)</code> inside instead. This is a bit of a mouthful. To break it down, it’s saying plot strain on the x-axis, but reorder the groups based on the median of the strain column (that’s the ‘-day4’ in the code).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="data-visualization.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(strain, <span class="sc">-</span>day4, median), <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="data-visualization.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb100-3"><a href="data-visualization.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-81-1.png" width="480" /></p>
<p>The output looks pretty good - it is now really easy to notice that one of the groups has a much lower distribution than the others. The major issue is that the label of the x-axis is terrible. So let’s fix that:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="data-visualization.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(strain, <span class="sc">-</span>day4, median), <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb101-2"><a href="data-visualization.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb101-3"><a href="data-visualization.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb101-4"><a href="data-visualization.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="data-visualization.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb101-6"><a href="data-visualization.html#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-82-1.png" width="480" /></p>
<p>Much nicer!</p>
<p><br></p>
</div>
<div id="flipping-axes" class="section level4" number="4.5.2.3">
<h4><span class="header-section-number">4.5.2.3</span> Flipping Axes</h4>
<p>Often boxplots look perfectly fine with the categorical grouping variable on the x-axis and the continuous variable on the y-axis. If you start to have many groups, then sometimes the boxplots looks too cluttered when placed on the x-axis. In this situation, it might look better to flip the axes, and have the boxplots stacked vertically. To do this, you write your plot code exactly as you would normally, but you just add <code>+ coord_flip()</code> to the end of the code.</p>
<p>Let’s add this to the reordered boxplots we just made in the previous section:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="data-visualization.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(strain, <span class="sc">-</span>day4, median), <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="data-visualization.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb102-3"><a href="data-visualization.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a href="data-visualization.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-5"><a href="data-visualization.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="data-visualization.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-7"><a href="data-visualization.html#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-83-1.png" width="480" /></p>
<p>This is OK, but it would be nicer if the highest values were at the top. There may well be a more straightforward way of doing this, but a quick solution is to wrap <code>reorder(strain, strain, median)</code> with <code>fct_rev</code>, so you now have <code>x = fct_rev(reorder(strain, strain, median))</code>. It’s a whole lot of code, but it does make the graph really pretty, so it’s worth it:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="data-visualization.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">reorder</span>(strain, <span class="sc">-</span>day4, median)), <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="data-visualization.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb103-3"><a href="data-visualization.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb103-4"><a href="data-visualization.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-5"><a href="data-visualization.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="data-visualization.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-7"><a href="data-visualization.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-84-1.png" width="480" /></p>
<p><br></p>
</div>
</div>
<div id="violin-plots" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Violin Plots</h3>
<p>A disadvantage of boxplots, especially when you have large distributions, is that the box does not tell you much about the overall shape of the distribution. An alternative are <strong>violin plots</strong>, where the width of the shape reflects the shape of the distribution. To make these plots, instead of using <code>geom_boxplot()</code> we use <code>geom_violin()</code>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="data-visualization.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> day4)) <span class="sc">+</span>  </span>
<span id="cb104-2"><a href="data-visualization.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb104-3"><a href="data-visualization.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-85-1.png" width="480" /></p>
<p>You can do all the customizing, reordering, coloring, transparency-ing, etc that you do with boxplots:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="data-visualization.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">reorder</span>(strain, strain, median)), <span class="at">y =</span> day4)) <span class="sc">+</span> </span>
<span id="cb105-2"><a href="data-visualization.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">color=</span><span class="st">&quot;navy&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb105-3"><a href="data-visualization.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb105-4"><a href="data-visualization.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="data-visualization.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="data-visualization.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-7"><a href="data-visualization.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-86-1.png" width="480" /></p>
</div>
<div id="stacked-boxplots" class="section level3" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Stacked Boxplots</h3>
<p>Sometimes, we want to compare distributions for the same group side by side. For instance, we may not just want to plot the day4 wheel running data, but also plot the day1 data.</p>
<p>Below, we have data in <strong>wide format</strong>. We have ids, strain, day1 running and day4 running.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="data-visualization.html#cb106-1" aria-hidden="true" tabindex="-1"></a>wheels2 <span class="ot">&lt;-</span> wheels <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, strain, day1, day4)</span>
<span id="cb106-2"><a href="data-visualization.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="data-visualization.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wheels2)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   id    strain   day1   day4
##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1 692ao B6     12853  12516.
## 2 656aa B6      2644   7404.
## 3 675ag B6      4004.  3761 
## 4 675ai B6     11754. 11684 
## 5 656af B6      6906.  8468.
## 6 656al B6      6517   9291</code></pre>
<p>We need to turn this to <strong>long data</strong> to be able to make the stacked boxplot graph. See section <a href="#wide-versus-long-data"><strong>??</strong></a> for more on how to switch between wide and long data formats:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="data-visualization.html#cb108-1" aria-hidden="true" tabindex="-1"></a>wheels2.long <span class="ot">&lt;-</span> wheels2 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">&quot;day&quot;</span>)</span>
<span id="cb108-2"><a href="data-visualization.html#cb108-2" aria-hidden="true" tabindex="-1"></a>wheels2.long</span></code></pre></div>
<pre><code>## # A tibble: 160 x 4
##    id    strain day    value
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt;
##  1 692ao B6     day1  12853 
##  2 692ao B6     day4  12516.
##  3 656aa B6     day1   2644 
##  4 656aa B6     day4   7404.
##  5 675ag B6     day1   4004.
##  6 675ag B6     day4   3761 
##  7 675ai B6     day1  11754.
##  8 675ai B6     day4  11684 
##  9 656af B6     day1   6906.
## 10 656af B6     day4   8468.
## # ... with 150 more rows</code></pre>
<p>Now the wheel running data is in its own column - <code>value</code>. So we use <code>y=value</code>. The grouping variable is in the <code>day</code> column, so we use <code>fill=day</code> to make separate boxplots based on the day. This will also make them different fill colors:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="data-visualization.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels2.long, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> value, <span class="at">fill=</span>day)) <span class="sc">+</span> </span>
<span id="cb110-2"><a href="data-visualization.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb110-3"><a href="data-visualization.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-89-1.png" width="480" /></p>
<p>This looks ok, but the colors are yucky. Lets add custom titles, labels, and we’ll customize the fill colors using <code>scale_fill_manual</code>. We have two groups (day1 and day4) so we need to provide two colors:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="data-visualization.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheels2.long, <span class="fu">aes</span>(<span class="at">x =</span> strain, <span class="at">y =</span> value, <span class="at">fill=</span>day)) <span class="sc">+</span> </span>
<span id="cb111-2"><a href="data-visualization.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb111-3"><a href="data-visualization.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb111-4"><a href="data-visualization.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#9381e3&quot;</span>, <span class="st">&quot;#faff75&quot;</span>)) <span class="sc">+</span></span>
<span id="cb111-5"><a href="data-visualization.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mouse Strain&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-6"><a href="data-visualization.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Revolutions&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="data-visualization.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mouse Wheel Running&quot;</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-90-1.png" width="480" /></p>
<p>It turns out all the strains increase their overall running in wheels from day 1 to day 4, except the S129 strain who get bored with wheel running - probably similar to how you’re bored of seeing graphs about wheel running.</p>
<p><br></p>
</div>
<div id="ridgeline-plots" class="section level3" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Ridgeline Plots</h3>
<p>Another useful way of displaying distributions of data across groups is using ridgeline plots. These are essentially density histogram plots for each categorical group plotted side by side. To do this we need to use a package called <code>ggridges</code>. This can be installed by going to the <code>Packages</code> tab, selecting <code>Install</code> and typing in <code>ggridges</code> in the box.</p>
<p>Let’s go back to the <code>olives</code> data. Say we are interested in displaying the distribution of <code>oleic</code> acid content by <code>macro.area</code>. We plot the categorical group of interest (here <code>macro.area</code>) on the y-axis, and the continuous variable whose distribution we are interested in (<code>oleic</code>) on the x-axis. We then use <code>stat_density_ridges()</code> to plot the ridgeline plots.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="data-visualization.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb112-2"><a href="data-visualization.html#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="data-visualization.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x =</span> oleic, <span class="at">y =</span> macro.area)) <span class="sc">+</span></span>
<span id="cb112-4"><a href="data-visualization.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb112-5"><a href="data-visualization.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-91-1.png" width="576" />
You can add color by adding in a <code>fill=</code> to the <code>aes()</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="data-visualization.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x =</span> oleic, <span class="at">y =</span> macro.area, <span class="at">fill =</span> macro.area)) <span class="sc">+</span></span>
<span id="cb113-2"><a href="data-visualization.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb113-3"><a href="data-visualization.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-92-1.png" width="576" />
… and perhaps we can manually override the default color scheme - here I’m using hex codes to pick a very purpley color scheme:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="data-visualization.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x =</span> oleic, <span class="at">y =</span> macro.area, <span class="at">fill =</span> macro.area)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="data-visualization.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb114-3"><a href="data-visualization.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb114-4"><a href="data-visualization.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#D1B8D0&quot;</span>, <span class="st">&quot;#F78EF2&quot;</span>, <span class="st">&quot;#AC33FF&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-93-1.png" width="576" />
A nice thing about these ridgeline plots is that we can easily add on lines that represent the lower quartile, median and upper quartile by adding in the argument <code>quantile_lines = TRUE</code> like this:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="data-visualization.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x =</span> oleic, <span class="at">y =</span> macro.area, <span class="at">fill =</span> macro.area)) <span class="sc">+</span></span>
<span id="cb115-2"><a href="data-visualization.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb115-3"><a href="data-visualization.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb115-4"><a href="data-visualization.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#D1B8D0&quot;</span>, <span class="st">&quot;#F78EF2&quot;</span>, <span class="st">&quot;#AC33FF&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-94-1.png" width="576" />
The final ridgeline plot below plots the distributions of oleic acid by region. There are 9 regions. It’s best in these plots to try and plot the categories from highest to lowest median, as it looks nicer. The following code is a bit tricky, and if you’re not interested - then you can safely ignore. However, just in case it is of interest to anyone: to do that you need to make sure <code>ggplot</code> recognizes the categorical variable <code>region</code> in this case to be a factor (a grouped variable) and that they are in the right order. It can be done using using this line: <code>fct_reorder(region, -oleic, .fun = median)</code>. Essentially this says, make the <code>region</code> variable a factor, and reorder it to be from highest median of oleic acid to lowest. One final thing - you have to do this for both the <code>y</code> axis category, and the <code>fill</code> - otherwise your colors won’t match your y-axis categories.</p>
<p>In the below code, I also added quantiles, x-axis and y-axis titles, a title and I removed the legend as it didn’t add any extra information that isn’t already on the plot.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="data-visualization.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(olives, <span class="fu">aes</span>(<span class="at">x =</span> oleic, </span>
<span id="cb116-2"><a href="data-visualization.html#cb116-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">fct_reorder</span>(region, <span class="sc">-</span>oleic, <span class="at">.fun =</span> median), </span>
<span id="cb116-3"><a href="data-visualization.html#cb116-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="fu">fct_reorder</span>(region, <span class="sc">-</span>oleic, <span class="at">.fun =</span> median)</span>
<span id="cb116-4"><a href="data-visualization.html#cb116-4" aria-hidden="true" tabindex="-1"></a>                   )) <span class="sc">+</span></span>
<span id="cb116-5"><a href="data-visualization.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">quantile_lines =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb116-6"><a href="data-visualization.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb116-7"><a href="data-visualization.html#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#0000FF&quot;</span>, <span class="st">&quot;#2000DF&quot;</span>, <span class="st">&quot;#4000BF&quot;</span>, <span class="st">&quot;#60009F&quot;</span>, <span class="st">&quot;#800080&quot;</span>, <span class="st">&quot;#9F0060&quot;</span>, <span class="st">&quot;#BF0040&quot;</span>, <span class="st">&quot;#DF0020&quot;</span>, <span class="st">&quot;#FF0000&quot;</span>)) <span class="sc">+</span></span>
<span id="cb116-8"><a href="data-visualization.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-9"><a href="data-visualization.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Region&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-10"><a href="data-visualization.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Oleic Acid Content&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-11"><a href="data-visualization.html#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Oleic Acid Content of Italian Olives by Region&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-95-1.png" width="576" /></p>
<p>For more information about these plots, you can look up the help documentation for this <a href="https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html">package here</a>.</p>
<p><br><br><br></p>
</div>
</div>
<div id="bar-graphs" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Bar Graphs</h2>
<p>A common form of data that we wish to show are the amounts of different categories. Often these data could be presented in a table format. For instance, the table below shows the total number of number 1 hits by six different artists in the UK.</p>
<p><img src="img/tab1.png" style="width:30.0%" /></p>
<p>A table is a completely legitimate way to present data. A graphical way of presenting these same data would be to make a <strong>bar graph</strong>. In these plots we have a categorical grouping variable on the x-axis and a numerical value (either continuous or discrete) on the y-axis. An advantage of bar graphs over tables is that it is often easier to visualize the proportional differences between categories in their values when looking at a bar graph compared to a table. Bar graphs are therefore especially useful when the differences between groups are larger.</p>
<p>If we wish to make a bar graph using <code>ggplot()</code> our data may come in two different ways. First, we may already have the totals that we wish to plot - that is our dataset already contains the values that the bar heights will be at. Second, we may not have these counts but need R to calculate them for us. These two different initial data setups require different geoms to create bar graphs.</p>
<p><strong>geom_col()</strong></p>
<p>Let’s first describe the situation when you have a dataset where you <em>have</em> already counted the number that applies to each group. We will use the <code>number1s.csv</code> data which contains the same data as the table above.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="data-visualization.html#cb117-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/number1s.csv&quot;</span>)</span>
<span id="cb117-2"><a href="data-visualization.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   name          total
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 Elvis            21
## 2 The Beatles      17
## 3 Cliff Richard    14
## 4 Westlife         14
## 5 Madonna          13
## 6 Take That        12</code></pre>
<p>When data look like this and you have one column that is the category (<code>x = name</code>) and one column containing the numerical data <code>y = total</code>, you can use <code>geom_col()</code>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="data-visualization.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> total) ) <span class="sc">+</span> </span>
<span id="cb119-2"><a href="data-visualization.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb119-3"><a href="data-visualization.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-97-1.png" width="480" /></p>
<p>Notice that the default order is alphabetical. You can reorder by putting <code>reorder</code> around the x-axis column. If you put <code>reorder(name, total)</code> this is telling it to reorder the <code>name</code> variable by their respective increasing values of total:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="data-visualization.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, total), <span class="at">y =</span> total) ) <span class="sc">+</span></span>
<span id="cb120-2"><a href="data-visualization.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb120-3"><a href="data-visualization.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-98-1.png" width="480" /></p>
<p>Alternatively, if you put <code>reorder(name, -total)</code>, with the <code>-</code> sign in front of ‘total’, this is telling it to reorder the <code>name</code> variable by their respective decreasing values of total:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="data-visualization.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, <span class="sc">-</span>total), <span class="at">y =</span> total) ) <span class="sc">+</span> </span>
<span id="cb121-2"><a href="data-visualization.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb121-3"><a href="data-visualization.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-99-1.png" width="480" /></p>
<p>To change the color of the bars, you need to put <code>fill=</code> inside <code>geom_col()</code> as we are dealing with filling in a shape:</p>
<p>When changing color use ‘fill’ here because it’s a shape.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="data-visualization.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, <span class="sc">-</span>total), <span class="at">y =</span> total) ) <span class="sc">+</span> </span>
<span id="cb122-2"><a href="data-visualization.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#32b5ed&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-3"><a href="data-visualization.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-100-1.png" width="480" /></p>
<p>If you wish to add a different color border around the bars, then you can add <code>color=</code> inside the <code>geom_col()</code>:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="data-visualization.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, <span class="sc">-</span>total), <span class="at">y =</span> total) ) <span class="sc">+</span> </span>
<span id="cb123-2"><a href="data-visualization.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#32b5ed&quot;</span>, <span class="at">color=</span><span class="st">&quot;#193642&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-3"><a href="data-visualization.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-101-1.png" width="480" /></p>
<p>And, as per usual, all other customizations are acceptable, including rotating the chart using <code>coord_flip()</code>:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="data-visualization.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, total), <span class="at">y =</span> total) ) <span class="sc">+</span> </span>
<span id="cb124-2"><a href="data-visualization.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#32b5ed&quot;</span>, <span class="at">color=</span><span class="st">&quot;#193642&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-3"><a href="data-visualization.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-4"><a href="data-visualization.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total Number 1&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-5"><a href="data-visualization.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Number 1 hits in UK&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="data-visualization.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb124-7"><a href="data-visualization.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-102-1.png" width="480" /></p>
<p>In the code for this flipped bar graph, notice that we removed the <code>-</code> from next to <code>-total</code> when reordering. If we’d left it in, it would have plotted the bars in the opposite order. If you are unsure with your own data whether to use it or not - just see what happens with and without it. Bar graphs look better when the highest value is at the top.</p>
<p>One other key thing about bar graphs, is that they should technically <strong>start at 0</strong>. As you are visualizing amounts, it would be misleading to start the graph at e.g. 10 in the above example. That would distort the relationship of the length of the bars to each other. Some people extend this rule to all graphs, but this is a misconception. Often we don’t need to know where 0 is for boxplots for instance. However, it is generally important to know where 0 is for bar graphs if we wish to compare bars between groups.</p>
<p><strong>geom_bar()</strong></p>
<p>Often we want to make bar graphs to visualize how many we have of each group, but we don’t yet know how many we have! For example, take the following dataset which is found in <code>pets.csv</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="data-visualization.html#cb125-1" aria-hidden="true" tabindex="-1"></a>pets <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/pets.csv&quot;</span>)</span>
<span id="cb125-2"><a href="data-visualization.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pets)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   name    pet  
##   &lt;chr&gt;   &lt;chr&gt;
## 1 Leon    Cat  
## 2 Lesley  Dog  
## 3 Devon   Dog  
## 4 Timothy Dog  
## 5 Paul    None 
## 6 Jody    Cat</code></pre>
<p>These data show different individuals in a class in the <code>name</code> column and what their favorite pet is in the <code>pet</code> column. Perhaps we want to visualize which pets are the most popular. We’d like to get the total number of people who put ‘cat’ as their favorite, the total number of people that put ‘dog’ down and so on.</p>
<p>One quick way to visually inspect how many we have of each pet in the <code>pet</code> column is to use the function <code>table()</code>:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="data-visualization.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pets<span class="sc">$</span>pet)</span></code></pre></div>
<pre><code>## 
## Bird  Cat  Dog None 
##    2    6   11    6</code></pre>
<p>To make the bar graph of these data using <code>ggplot()</code>, we need to use <code>geom_bar()</code>. Fortunately, <code>geom_bar()</code> counts how many we have of each for us. We do not need to supply a y column. We just need to supply <code>x=pet</code> to indicate that that column will be our grouping variable.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="data-visualization.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pets, <span class="fu">aes</span>(<span class="at">x =</span> pet)) <span class="sc">+</span> </span>
<span id="cb129-2"><a href="data-visualization.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb129-3"><a href="data-visualization.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-105-1.png" width="480" /></p>
<p>Once we have the basic plot down, all the other bits and pieces can be done:</p>
<p>Then just customize.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="data-visualization.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pets, <span class="fu">aes</span>(<span class="at">x =</span> pet)) <span class="sc">+</span> </span>
<span id="cb130-2"><a href="data-visualization.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;plum3&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="data-visualization.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb130-4"><a href="data-visualization.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pet&quot;</span>)<span class="sc">+</span></span>
<span id="cb130-5"><a href="data-visualization.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>)<span class="sc">+</span></span>
<span id="cb130-6"><a href="data-visualization.html#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of Pets in a Class&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-106-1.png" width="480" /></p>
<p>You can also reorder your factor. With <code>geom_bar()</code> we reorder in a similar way to how we did with <code>geom_boxplot()</code>. We use <code>x = reorder(pet, pet, table)</code> to tell it to reorder the pet category according to the frequency count of each as calculated by the <code>table()</code> function. Using <code>coord_flip()</code> makes it easier to read and compare bars.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="data-visualization.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pets, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(pet, pet, table))) <span class="sc">+</span> </span>
<span id="cb131-2"><a href="data-visualization.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;plum3&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-3"><a href="data-visualization.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb131-4"><a href="data-visualization.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pet&quot;</span>)<span class="sc">+</span></span>
<span id="cb131-5"><a href="data-visualization.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>)<span class="sc">+</span></span>
<span id="cb131-6"><a href="data-visualization.html#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Popularity of Pets in a Class&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="data-visualization.html#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-107-1.png" width="480" /></p>
<p><br><br><br></p>
</div>
<div id="small-multiples" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Small Multiples</h2>
<p>Often we want to compare graphs across multiple categories. One good strategy to do this is to make <strong>small multiples</strong>, which is essentially replicating the same graph for each group several times in different panels. This is probably best explained by doing an example.</p>
<p><strong>Scatterplot small multiple</strong></p>
<p>Here, we load in the <code>penguins.csv</code> dataset. This data shows the size of various penguins culmen (the beak) and flippers:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="data-visualization.html#cb132-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/penguins.csv&quot;</span>)</span>
<span id="cb132-2"><a href="data-visualization.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(penguins)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   species island    culmen_length_mm culmen_depth_mm flipper_length_mm body_mass_g sex   
##   &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt;           &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
## 1 Adelie  Torgersen             39.1            18.7               181        3750 MALE  
## 2 Adelie  Torgersen             39.5            17.4               186        3800 FEMALE
## 3 Adelie  Torgersen             40.3            18                 195        3250 FEMALE
## 4 Adelie  Torgersen             36.7            19.3               193        3450 FEMALE
## 5 Adelie  Torgersen             39.3            20.6               190        3650 MALE  
## 6 Adelie  Torgersen             38.9            17.8               181        3625 FEMALE</code></pre>
<p>The dataset contains three different species:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="data-visualization.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>species)</span></code></pre></div>
<pre><code>## 
##    Adelie Chinstrap    Gentoo 
##       146        68       119</code></pre>
<p>We might be interested in examining how body mass is associated with flipper length across species and across sex. Here, we have two different columns containing categorical variables. We have <code>sex</code> and <code>species</code>. If we wanted to show all of this on just one scatterplot, we could change the color of the points to represent species, and the shape of the points to represent sex. We change the shape by a column using <code>shape=</code> inside of <code>aes()</code>:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="data-visualization.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g,  <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> species, <span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb136-2"><a href="data-visualization.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-3"><a href="data-visualization.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-110-1.png" width="480" /></p>
<p>The problem with this sort of graph is that it is far too cluttered. Using shape to distinguish categories isn’t that useful or helpful. You really have to squint at the graph to work out what is a circle and what is a triangle.</p>
<p>An alternative approach is to make small multiples. We create a separate scatterplot for each species. Here, we color our points by sex with <code>color=sex</code> inside <code>aes()</code>. We add to our code the line <code>facet_wrap(~species)</code> to tell <code>ggplot()</code> to make separate scatterplots for each species. Please note the <code>~</code> that comes before the column name that you wish to make separate plots for:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="data-visualization.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g,  <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb137-2"><a href="data-visualization.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb137-3"><a href="data-visualization.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb137-4"><a href="data-visualization.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-111-1.png" width="768" /></p>
<p>You may notice that all the scatterplots have the same range of values on the x-axis. Technically, this is the most appropriate approach as it enables you to make comparisons across groups more easily. However, if you want to fit the data on each scatterplot to cover the whole canvas, you can make the axes unfixed by adding <code>scales="free"</code> to your <code>facet_wrap()</code> command:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="data-visualization.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g,  <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb138-2"><a href="data-visualization.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="data-visualization.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-4"><a href="data-visualization.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-112-1.png" width="768" /></p>
<p><strong>Line graph small multiple</strong></p>
<p>We can also make small multiples for line graphs. Let’s illustrate this using the <code>lifeexp_all.csv</code> dataset.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="data-visualization.html#cb139-1" aria-hidden="true" tabindex="-1"></a>le <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/lifeexp_all.csv&quot;</span>)</span>
<span id="cb139-2"><a href="data-visualization.html#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="data-visualization.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(le)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   country     continent  year lifeExp      pop gdpPercap
##   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 Afghanistan Asia       1952    28.8  8425333      779.
## 2 Afghanistan Asia       1957    30.3  9240934      821.
## 3 Afghanistan Asia       1962    32.0 10267083      853.
## 4 Afghanistan Asia       1967    34.0 11537966      836.
## 5 Afghanistan Asia       1972    36.1 13079460      740.
## 6 Afghanistan Asia       1977    38.4 14880372      786.</code></pre>
<p>In this dataset we have a column giving the life expectancy (<code>lifeExp</code>) of various countries that are in the <code>country</code> column. We also have a <code>year</code> column that goes from 1952 to 2007 at five year intervals. Consequently, we could plot a line graph of year on the x-axis and life expectancy on the y-axis. We could make separate lines for each country. As there are far too many countries to plot, it is not worth making each one a separate color. Because of this, rather than putting <code>color=country</code> into <code>aes()</code> to indicate to make separate lines for each country, we’ll put <code>group=country</code>. This will make separate lines for each country, but make them all the same color. If we make them a light color and a bit transparent, it will look best:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="data-visualization.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(le, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">group =</span> country)) <span class="sc">+</span> </span>
<span id="cb141-2"><a href="data-visualization.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb141-3"><a href="data-visualization.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-114-1.png" width="480" /></p>
<p>This gives us a sense of the overall pattern of life expectancies from 1952 to 2007. The trend for most countries is generally upwards, though there are some countries that have big crashes.</p>
<p>We also have another categorical variable in our dataset. There is a column called <code>continent</code>. We could replot this line graph, but separate the plots based on which continent the lines/countries belong to. We do that again using <code>facet_wrap(~continent)</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-visualization.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(le, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">group =</span> country)) <span class="sc">+</span> </span>
<span id="cb142-2"><a href="data-visualization.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb142-3"><a href="data-visualization.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb142-4"><a href="data-visualization.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>continent)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-115-1.png" width="864" /></p>
<p>Because there are fewer lines on each graph, we upped the alpha to 0.5 to make the lines a bit darker on this plot.</p>
<p>If you wish to make the lines belonging to each panel different colors from each other, you can add <code>color=continent</code> to your <code>aes()</code>. You have to remove the color from <code>geom_line()</code> to make this work:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="data-visualization.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(le, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">group =</span> country, <span class="at">color =</span> continent)) <span class="sc">+</span> </span>
<span id="cb143-2"><a href="data-visualization.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb143-3"><a href="data-visualization.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb143-4"><a href="data-visualization.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>continent)<span class="sc">+</span></span>
<span id="cb143-5"><a href="data-visualization.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="data-visualization.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-116-1.png" width="864" /></p>
<p><br><br><br></p>
</div>
<div id="saving-and-exporting-ggplot2-graphs" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Saving and Exporting ggplot2 graphs</h2>
<p>How do we save the nice plots that we have made using ggplot2? There are some quite advanced ways of saving high resolution images. Here, we’ll just run through some quick and easy options.</p>
<p>First, you could just hit <code>zoom</code> in RStudio to make your plot bigger. Resize the window to your preferred graph size and then take a screenshot. Paste your screenshot into a program such as paint and crop away. This is a very crude method - but it’s fast and reliable if you just want to have an image to insert into some other program.</p>
<p><img src="img/zoom.png" style="width:50.0%" /></p>
<p>A second option is after you have made your plot, you can hit the ‘export’ tab on the plot viewer. Choose either “Save as Image” or “Save as PDF” and then choose how and where you want to save the image.</p>
<p><img src="img/zoom2.png" style="width:50.0%" /></p>
<p>A more premium option is to use a function from ggplot called <code>ggsave()</code>. The first step you should do is to assign your plot to an object name. In the code below, we are making a scatterplot that we save to the object <code>plot1</code>:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-visualization.html#cb144-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cheese, <span class="fu">aes</span>(<span class="at">x =</span> chol, <span class="at">y =</span> kcal)) <span class="sc">+</span> </span>
<span id="cb144-2"><a href="data-visualization.html#cb144-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;purple&#39;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb144-3"><a href="data-visualization.html#cb144-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb144-4"><a href="data-visualization.html#cb144-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">&quot;Cholesterol&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-5"><a href="data-visualization.html#cb144-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="st">&quot;Calories in kcal&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-6"><a href="data-visualization.html#cb144-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ggtitle</span>(<span class="st">&quot;Cheese&quot;</span>)</span>
<span id="cb144-7"><a href="data-visualization.html#cb144-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-8"><a href="data-visualization.html#cb144-8" aria-hidden="true" tabindex="-1"></a>plot1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-117-1.png" width="480" /></p>
<p>Next, run a line of code that will save your plot. You type <code>ggsave()</code>. The first thing you put inside this is the location where you want your plot to be stored. You need to write a location on your computer. If you are using an Rproject such as with this course, you could put your plot in a folder called <code>img</code>. Remember to type the file extension <code>.png</code> or <code>.pdf</code> after the name of your new plot. The second thing you need to write is the name of the graph object you wish to save. Here our graph is called <code>plot1</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="data-visualization.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/cheese_plot.png&quot;</span>, plot1)  <span class="co"># save as a png</span></span>
<span id="cb145-2"><a href="data-visualization.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="data-visualization.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/cheese_plot.pdf&quot;</span>, plot1)  <span class="co"># save as a pdf</span></span></code></pre></div>
<p>You can also play around with the width and height of your saved image. You probably need to trial and error this a few times to get the proportions that you really like. Here we are making an image that is 10 inches wide and 8 inches high.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-visualization.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/cheese_plot2.png&quot;</span>, plot1, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)  <span class="co">#(in inches, though can be in cm)</span></span></code></pre></div>
<p><br><br><br></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-caucus-race-and-a-long-tale.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jalapic/introstats/edit/master/04-DataViz.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jalapic/introstats/blob/master/04-DataViz.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
